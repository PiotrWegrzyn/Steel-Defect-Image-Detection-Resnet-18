import cv2
import numpy as np
import matplotlib.pyplot as plt

rle = "7198 64 7454 64 7710 64 7966 64 8222 64 8478 64 8727 83 8983 83 9239 83 9495 83 9751 83 10007 83 10263 83 10515 95 10771 95 11027 95 11283 95 11539 95 11795 95 12049 102 12305 102 12561 102 12817 102 13073 102 13329 102 13583 109 13839 109 14095 109 14351 109 14607 109 14863 109 15118 115 15374 115 15630 115 15886 115 16142 115 16398 115 16654 115 16908 120 17164 120 17420 120 17676 120 17932 120 18188 120 18443 124 18699 124 18955 124 19211 124 19467 124 19723 124 19979 126 20235 126 20491 126 20747 126 21003 126 21259 126 21514 129 21770 129 22026 129 22282 129 22538 129 22794 129 23050 129 23306 131 23562 131 23818 131 24074 131 24330 131 24586 131 24841 133 25097 133 25353 133 25609 133 25865 133 26121 133 26377 134 26633 134 26889 134 27145 134 27401 134 27657 134 27913 135 28169 135 28425 135 28681 135 28937 135 29193 135 29449 135 29705 137 29961 137 30217 137 30473 137 30729 137 30985 137 31241 137 31497 137 31753 137 32009 137 32265 137 32521 137 32776 139 33032 139 33288 139 33544 139 33800 139 34056 139 34312 139 34568 139 34824 139 35080 139 35336 139 35592 139 35848 139 36104 139 36360 139 36616 139 36872 139 37128 139 37384 139 37640 140 37896 140 38152 140 38408 140 38664 140 38920 140 39176 140 39432 140 39688 140 39944 140 40200 140 40456 140 40712 140 40968 140 41224 140 41480 140 41736 140 41992 140 42248 140 42504 140 42760 140 43016 140 43272 140 43528 140 43784 140 44040 140 44296 140 44552 140 44808 140 45064 140 45320 140 45576 140 45832 140 46088 140 46344 140 46600 140 46856 140 47112 139 47368 139 47624 139 47880 139 48136 139 48392 139 48648 139 48904 138 49160 138 49416 138 49672 138 49928 138 50184 138 50441 136 50697 136 50953 136 51209 136 51465 136 51721 136 51977 136 52233 136 52489 136 52745 136 53001 136 53257 136 53513 135 53769 135 54025 135 54281 135 54537 135 54793 135 55049 135 55305 134 55561 134 55817 134 56073 134 56329 134 56585 134 56841 133 57097 133 57353 133 57609 133 57865 133 58121 133 58378 131 58634 131 58890 131 59146 131 59402 131 59658 131 59914 131 60170 131 60426 131 60682 131 60938 131 61194 131 61450 131 61706 130 61962 130 62218 130 62474 130 62730 130 62986 130 63243 128 63499 128 63755 128 64011 128 64267 128 64523 128 64779 126 65035 126 65291 126 65547 126 65803 126 66059 126 66315 122 66571 122 66827 122 67083 122 67339 122 67595 122 67851 122 68108 120 68364 120 68620 120 68876 120 69132 120 69388 120 69645 119 69901 119 70157 119 70413 119 70669 119 70925 119 71181 117 71437 117 71693 117 71949 117 72205 117 72461 117 72717 115 72973 115 73229 115 73485 115 73741 115 73997 115 74253 115 74509 114 74765 114 75021 114 75277 114 75533 114 75789 114 76046 111 76302 111 76558 111 76814 111 77070 111 77326 111 77582 108 77838 108 78094 108 78350 108 78606 108 78862 108 79119 105 79375 105 79631 105 79887 105 80143 105 80399 105 80655 105 80911 104 81167 104 81423 104 81679 104 81935 104 82191 104 82447 101 82703 101 82959 101 83215 101 83471 101 83727 101 83984 99 84240 99 84496 99 84752 99 85008 99 85264 99 85520 98 85776 98 86032 98 86288 98 86544 98 86800 98 87056 98 87313 93 87569 93 87825 93 88081 93 88337 93 88593 93 88849 92 89105 92 89361 92 89617 92 89873 92 90129 92 90385 90 90641 90 90897 90 91153 90 91409 90 91665 90 91922 87 92178 87 92434 87 92690 87 92946 87 93202 87 93458 87 93715 84 93971 84 94227 84 94483 84 94739 84 94995 84 95251 81 95507 81 95763 81 96019 81 96275 81 96531 81 96789 76 97045 76 97301 76 97557 76 97813 76 98069 76 98326 65 98582 65 98838 65 99094 65 99350 65 99606 65 99862 65 100119 58 100375 58 100631 58 100887 58 101143 58 101399 58 101657 53 101913 53 102169 53 102425 53 102681 53 102937 53 103196 43 103452 43 103708 43 103964 43 104220 43 104476 43 104734 40 104990 40 105246 40 105502 40 105758 40 106014 40 106270 40 106530 2 106534 26 106561 3 106786 2 106790 26 106817 3 107042 2 107046 26 107073 3 107298 2 107302 26 107329 3 107554 2 107558 26 107585 3 107810 2 107814 26 107841 3 108073 4 108088 5 108329 4 108344 5 108585 4 108600 5 108841 4 108856 5 109097 4 109112 5 109353 4 109368 5 301792 4 301797 4 302048 4 302053 4 302304 4 302309 4 302560 4 302565 4 302816 4 302821 4 303072 4 303077 4 303323 16 303579 16 303835 16 304091 16 304347 16 304603 16 304859 16 305114 21 305370 21 305626 21 305882 21 306138 21 306394 21 306648 25 306904 25 307160 25 307416 25 307672 25 307928 25 308183 27 308439 27 308695 27 308951 27 309207 27 309463 27 309718 29 309974 29 310230 29 310486 29 310742 29 310998 29 311254 29 311508 33 311764 33 312020 33 312276 33 312532 33 312788 33 313043 35 313299 35 313555 35 313811 35 314067 35 314323 35 314393 2 314578 37 314649 2 314834 37 314905 2 315090 37 315161 2 315346 37 315417 2 315602 37 315673 2 315858 37 315926 7 316113 38 316182 7 316369 38 316438 7 316625 38 316694 7 316881 38 316950 7 317137 38 317206 7 317393 38 317462 7 317649 38 317715 18 317905 39 317971 18 318161 39 318227 18 318417 39 318483 18 318673 39 318739 18 318929 39 318995 18 319185 39 319250 23 319440 40 319506 23 319696 40 319762 23 319952 40 320018 23 320208 40 320274 23 320464 40 320530 23 320720 40 320785 29 320974 43 321041 29 321230 43 321297 29 321486 43 321553 29 321742 43 321809 29 321998 43 322065 29 322254 43 322321 30 322508 45 322577 30 322764 45 322833 30 323020 45 323089 30 323276 45 323345 30 323532 45 323601 30 323788 45 323857 30 324044 45 324113 30 324300 45 324369 30 324556 45 324625 30 324812 45 324881 30 325068 45 325137 30 325324 45 325393 30 325580 45 325649 31 325835 46 325905 31 326091 46 326161 31 326347 46 326417 31 326603 46 326673 31 326859 46 326929 31 327115 46 327185 33 327370 48 327441 33 327626 48 327697 33 327882 48 327953 33 328138 48 328209 33 328394 48 328465 33 328650 48 328721 34 328906 48 328977 34 329162 48 329233 34 329418 48 329489 34 329674 48 329745 34 329930 48 330001 34 330186 48 330257 34 330442 48 330512 37 330697 49 330768 37 330953 49 331024 37 331209 49 331280 37 331465 49 331536 37 331721 49 331792 37 331977 49 332048 39 332233 49 332304 39 332489 49 332560 39 332745 49 332816 39 333001 49 333072 39 333257 49 333328 39 333513 49 333584 40 333768 50 333840 40 334024 50 334096 40 334280 50 334352 40 334536 50 334608 40 334792 50 334864 40 335048 50 335120 41 335304 50 335376 41 335560 50 335632 41 335816 50 335888 41 336072 50 336144 41 336328 50 336400 41 336584 50 336656 41 336840 50 336912 43 337095 51 337168 43 337351 51 337424 43 337607 51 337680 43 337863 51 337936 43 338119 51 338192 43 338375 51 338447 45 338631 51 338703 45 338887 51 338959 45 339143 51 339215 45 339399 51 339471 45 339655 51 339727 45 339911 51 339983 45 340166 52 340239 45 340422 52 340495 45 340678 52 340751 45 340934 52 341007 45 341190 52 341263 45 341446 52 341519 46 341702 52 341775 46 341958 52 342031 46 342214 52 342287 46 342470 52 342543 46 342726 52 342799 46 342982 52 343055 46 343238 52 343310 48 343494 52 343566 48 343750 52 343822 48 344006 52 344078 48 344262 52 344334 48 344518 52 344590 48 344774 52 344846 49 345029 53 345102 49 345285 53 345358 49 345541 53 345614 49 345797 53 345870 49 346053 53 346126 49 346309 53 346382 50 346565 53 346638 50 346821 53 346894 50 347077 53 347150 50 347333 53 347406 50 347589 53 347662 50 347845 53 347918 50 348100 54 348174 50 348356 54 348430 50 348612 54 348686 50 348868 54 348942 50 349124 54 349198 50 349380 54 349454 50 349636 54 349709 52 349892 55 349965 52 350148 55 350221 52 350404 55 350477 52 350660 55 350733 52 350916 55 350989 52 351172 55 351245 52 351428 55 351501 52 351684 55 351757 52 351940 55 352013 52 352196 55 352269 52 352452 55 352525 52 352708 55 352781 53 352963 56 353037 53 353219 56 353293 53 353475 56 353549 53 353731 56 353805 53 353987 56 354061 53 354243 56 354317 53 354499 56 354573 53 354755 56 354829 53 355011 56 355085 53 355267 56 355341 53 355523 56 355597 53 355779 56 355853 53 356035 56 356108 55 356291 56 356364 55 356547 56 356620 55 356803 56 356876 55 357059 56 357132 55 357315 56 357388 55 357571 56 357644 55 357826 57 357900 55 358082 57 358156 55 358338 57 358412 55 358594 57 358668 55 358850 57 358924 55 359106 57 359180 55 359362 57 359436 55 359618 57 359692 55 359874 57 359948 55 360130 57 360204 55 360386 57 360460 55 360642 57 360716 55 360898 57 360972 55 361154 57 361228 55 361410 57 361484 55 361666 57 361740 55 361922 57 361996 55 362178 57 362252 55 362434 57 362508 55 362690 57 362764 55 362946 57 363020 55 363202 57 363276 55 363458 57 363532 55 363714 57 363788 55 363970 57 364044 55 364226 57 364300 55 364482 57 364556 55 364738 57 364812 55 364994 57 365068 55 365250 57 365324 55 365506 57 365580 55 365763 56 365836 55 366019 56 366092 55 366275 56 366348 55 366531 56 366604 55 366787 56 366860 55 367043 56 367117 54 367299 56 367373 54 367555 56 367629 54 367811 56 367885 54 368067 56 368141 54 368323 56 368397 54 368579 56 368653 54 368835 56 368909 50 369091 56 369165 50 369347 56 369421 50 369603 56 369677 50 369859 56 369933 50 370115 56 370189 50 370371 56 370445 50 370627 56 370701 50 370883 56 370957 50 371139 56 371213 50 371395 56 371469 50 371651 56 371725 50 371907 56 371981 50 372164 54 372237 50 372420 54 372493 50 372676 54 372749 50 372932 54 373005 50 373188 54 373261 50 373444 54 373518 49 373701 53 373774 49 373957 53 374030 49 374213 53 374286 49 374469 53 374542 49 374725 53 374798 49 374981 53 375054 49 375237 53 375310 49 375494 52 375566 49 375750 52 375822 49 376006 52 376078 49 376262 52 376334 49 376518 52 376590 49 376774 52 376847 47 377031 51 377103 47 377287 51 377359 47 377543 51 377615 47 377799 51 377871 47 378055 51 378127 47 378311 51 378384 46 378567 51 378640 46 378823 51 378896 46 379079 51 379152 46 379335 51 379408 46 379591 51 379664 46 379847 51 379921 44 380104 49 380177 44 380360 49 380433 44 380616 49 380689 44 380872 49 380945 44 381128 49 381201 44 381384 49 381457 44 381640 49 381714 43 381896 49 381970 43 382152 49 382226 43 382408 49 382482 43 382664 49 382738 43 382920 49 382994 43 383176 49 383251 40 383433 48 383507 40 383689 48 383763 40 383945 48 384019 40 384201 48 384275 40 384457 48 384531 40 384713 48 384787 39 384970 47 385043 39 385226 47 385299 39 385482 47 385555 39 385738 47 385811 39 385994 47 386067 39 386250 47 386323 37 386507 46 386579 37 386763 46 386835 37 387019 46 387091 37 387275 46 387347 37 387531 46 387603 37 387787 46 387859 37 388043 46 388116 34 388299 46 388372 34 388555 46 388628 34 388811 46 388884 34 389067 46 389140 34 389323 46 389396 34 389579 46 389653 28 389836 44 389909 28 390092 44 390165 28 390348 44 390421 28 390604 44 390677 28 390860 44 390933 28 391116 44 391192 11 391374 42 391448 11 391630 42 391704 11 391886 42 391960 11 392142 42 392216 11 392398 42 392472 11 392654 42 392913 38 393169 38 393425 38 393681 38 393937 38 394193 38 394449 38 394706 36 394962 36 395218 36 395474 36 395730 36 395986 36 396244 33 396500 33 396756 33 397012 33 397268 33 397524 33 397785 26 398041 26 398297 26 398553 26 398809 26 399065 26 399326 17 399582 17 399838 17 400094 17 400350 17 400606 17 400862 17"

def decode_rl_pixels(rle_string):
    rle_list = rle_string.split(" ")
    pixels = []
    for index in range(0, len(rle_list), 2):
        starting_pixel = int(rle_list[index])
        occurrences = int(rle_list[index+1])
        for dx in range(0, occurrences):
            pixels.append(starting_pixel + dx)

    return pixels

mask_pixels = decode_rl_pixels(rle)

path = './severstal-steel-defect-detection/'+'test_images/'
image_name = '0c124b96b.jpg'
img_location = path + image_name

img = cv2.imread(img_location)
plt.imshow(img)
plt.show()
mask_img = np.zeros((256*1600,1), dtype=int)
mask_img[mask_pixels] = 255

l = cv2.imread(img_location).shape[0]
b = cv2.imread(img_location).shape[1]
mask = np.reshape(mask_img, (b, l)).T

plt.imshow(mask)
plt.show()


